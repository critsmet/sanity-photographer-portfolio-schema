{"version":3,"sources":["../../src/middleware/jsonRequest.js"],"names":["objectAssign","require","isPlainObject","serializeTypes","isBuffer","obj","constructor","module","exports","processOptions","body","options","isStream","pipe","shouldSerialize","indexOf","Array","isArray","JSON","stringify","headers"],"mappings":";;;;AAAA,IAAMA,eAAeC,QAAQ,eAAR,CAArB;AACA,IAAMC,gBAAgBD,QAAQ,iBAAR,CAAtB;;AAEA,IAAME,iBAAiB,CAAC,SAAD,EAAY,QAAZ,EAAsB,QAAtB,CAAvB;AACA,IAAMC,WAAW,SAAXA,QAAW;AAAA,SACf,CAAC,CAACC,IAAIC,WAAN,IACG,OAAOD,IAAIC,WAAJ,CAAgBF,QAAvB,KAAoC,UADvC,IAEGC,IAAIC,WAAJ,CAAgBF,QAAhB,CAAyBC,GAAzB,CAHY;AAAA,CAAjB;;AAMAE,OAAOC,OAAP,GAAiB;AAAA,SAAO;AACtBC,oBAAgB,iCAAW;AACzB,UAAMC,OAAOC,QAAQD,IAArB;AACA,UAAI,CAACA,IAAL,EAAW;AACT,eAAOC,OAAP;AACD;;AAED,UAAMC,WAAW,OAAOF,KAAKG,IAAZ,KAAqB,UAAtC;AACA,UAAMC,kBAAkB,CAACF,QAAD,IAAa,CAACR,SAASM,IAAT,CAAd,KACtBP,eAAeY,OAAf,QAA8BL,IAA9B,yCAA8BA,IAA9B,OAAwC,CAAC,CAAzC,IACGM,MAAMC,OAAN,CAAcP,IAAd,CADH,IAEGR,cAAcQ,IAAd,CAHmB,CAAxB;;AAMA,UAAI,CAACI,eAAL,EAAsB;AACpB,eAAOH,OAAP;AACD;;AAED,aAAOX,aAAa,EAAb,EAAiBW,OAAjB,EAA0B;AAC/BD,cAAMQ,KAAKC,SAAL,CAAeR,QAAQD,IAAvB,CADyB;AAE/BU,iBAASpB,aAAa,EAAb,EAAiBW,QAAQS,OAAzB,EAAkC;AACzC,0BAAgB;AADyB,SAAlC;AAFsB,OAA1B,CAAP;AAMD;AAxBqB,GAAP;AAAA,CAAjB","file":"jsonRequest.js","sourcesContent":["const objectAssign = require('object-assign')\nconst isPlainObject = require('is-plain-object')\n\nconst serializeTypes = ['boolean', 'string', 'number']\nconst isBuffer = obj => (\n  !!obj.constructor\n  && typeof obj.constructor.isBuffer === 'function'\n  && obj.constructor.isBuffer(obj)\n)\n\nmodule.exports = () => ({\n  processOptions: options => {\n    const body = options.body\n    if (!body) {\n      return options\n    }\n\n    const isStream = typeof body.pipe === 'function'\n    const shouldSerialize = !isStream && !isBuffer(body) && (\n      serializeTypes.indexOf(typeof body) !== -1\n      || Array.isArray(body)\n      || isPlainObject(body)\n    )\n\n    if (!shouldSerialize) {\n      return options\n    }\n\n    return objectAssign({}, options, {\n      body: JSON.stringify(options.body),\n      headers: objectAssign({}, options.headers, {\n        'Content-Type': 'application/json'\n      })\n    })\n  }\n})\n"]}