"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = insert;
exports.AFTER = exports.BEFORE = void 0;
const BEFORE = 'before';
exports.BEFORE = BEFORE;
const AFTER = 'after';
exports.AFTER = AFTER;

function insert(array, position, index, ...args) {
  if (position !== BEFORE && position !== AFTER) {
    throw new Error(`Invalid position "${position}", must be either ${BEFORE} or ${AFTER}`);
  }

  const items = flatten(...args);

  if (array.length === 0) {
    return items;
  }

  const len = array.length;
  const idx = Math.abs((len + index) % len) % len;
  const normalizedIdx = position === 'after' ? idx + 1 : idx;
  const copy = array.slice();
  copy.splice(normalizedIdx, 0, ...flatten(items));
  return copy;
}

function flatten(...values) {
  return values.reduce((prev, item) => prev.concat(item), []);
}