(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.SanityImageUrlBuilder = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
module.exports=require("./lib/builder").default;
},{"./lib/builder":2}],2:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){_defineProperty(t,e,i[e])})}return t}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function urlBuilder(t){return t&&"object"===_typeof(t.clientConfig)?new ImageUrlBuilder(null,{baseUrl:t.clientConfig.apiHost.replace(/^https:\/\/api\./,"https://cdn."),projectId:t.clientConfig.projectId,dataset:t.clientConfig.dataset}):new ImageUrlBuilder(null,t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=urlBuilder;var _urlForImage=_interopRequireDefault(require("./urlForImage")),validFits=["clip","crop","fill","fillmax","max","scale","min"],validCrops=["top","bottom","left","right","center","focalpoint","entropy"],ImageUrlBuilder=function(){function t(e,i){_classCallCheck(this,t),this.options=e?_objectSpread({},e.options||{},i||{}):i||{}}return _createClass(t,[{key:"withOptions",value:function(e){return new t(this,e)}},{key:"image",value:function(t){return this.withOptions({source:t})}},{key:"dataset",value:function(t){return this.withOptions({dataset:t})}},{key:"projectId",value:function(t){return this.withOptions({projectId:t})}},{key:"bg",value:function(t){return this.withOptions({bg:t})}},{key:"width",value:function(t){return this.withOptions({width:t})}},{key:"height",value:function(t){return this.withOptions({height:t})}},{key:"focalPoint",value:function(t,e){return this.withOptions({focalPoint:{x:t,y:e}})}},{key:"maxWidth",value:function(t){return this.withOptions({maxWidth:t})}},{key:"minWidth",value:function(t){return this.withOptions({minWidth:t})}},{key:"maxHeight",value:function(t){return this.withOptions({maxHeight:t})}},{key:"minHeight",value:function(t){return this.withOptions({minHeight:t})}},{key:"size",value:function(t,e){return this.withOptions({width:t,height:e})}},{key:"blur",value:function(t){return this.withOptions({blur:t})}},{key:"sharpen",value:function(t){return this.withOptions({sharpen:t})}},{key:"rect",value:function(t,e,i,n){return this.withOptions({rect:{left:t,top:e,width:i,height:n}})}},{key:"format",value:function(t){return this.withOptions({format:t})}},{key:"invert",value:function(t){return this.withOptions({invert:t})}},{key:"orientation",value:function(t){return this.withOptions({orientation:t})}},{key:"quality",value:function(t){return this.withOptions({quality:t})}},{key:"forceDownload",value:function(t){return this.withOptions({download:t})}},{key:"flipHorizontal",value:function(){return this.withOptions({flipHorizontal:!0})}},{key:"flipVertical",value:function(){return this.withOptions({flipVertical:!0})}},{key:"ignoreImageParams",value:function(){return this.withOptions({ignoreImageParams:!0})}},{key:"fit",value:function(t){if(-1===validFits.indexOf(t))throw new Error('Invalid fit mode "'.concat(t,'"'));return this.withOptions({fit:t})}},{key:"crop",value:function(t){if(-1===validCrops.indexOf(t))throw new Error('Invalid crop mode "'.concat(t,'"'));return this.withOptions({crop:t})}},{key:"url",value:function(){return(0,_urlForImage.default)(this.options)}},{key:"toString",value:function(){return this.url()}}]),t}();
},{"./urlForImage":5}],3:[function(require,module,exports){
"use strict";function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,r){var t=[],a=!0,i=!1,n=void 0;try{for(var o,l=e[Symbol.iterator]();!(a=(o=l.next()).done)&&(t.push(o.value),!r||t.length!==r);a=!0);}catch(e){i=!0,n=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw n}}return t}function _arrayWithHoles(e){if(Array.isArray(e))return e}function parseAssetId(e){var r=e.split("-"),t=_slicedToArray(r,4),a=t[1],i=t[2],n=t[3];if(!a||!i||!n)throw new Error("Malformed asset _ref '".concat(e,"'. Expected an id like \"").concat(example,'".'));var o=i.split("x"),l=_slicedToArray(o,2),s=l[0],c=l[1],u=+s,d=+c;if(!isFinite(u)||!isFinite(d))throw new Error("Malformed asset _ref '".concat(e,"'. Expected an id like \"").concat(example,'".'));return{id:a,width:u,height:d,format:n}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=parseAssetId;var example="image-Tb9Ew8CXIwaY6R1kjMvI0uRR-2000x3000-jpg";
},{}],4:[function(require,module,exports){
"use strict";function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),o.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function parseSource(e){if(!e)return null;var t;if("string"==typeof e&&isUrl(e))t={asset:{_ref:urlToId(e)}};else if("string"==typeof e)t={asset:{_ref:e}};else if("string"==typeof e._ref)t={asset:e};else if(e._id)t={asset:{_ref:e._id}};else if(e.asset&&e.asset.url&&!e.asset._ref)t={asset:{_ref:urlToId(e.asset.url)}};else{if("object"!==_typeof(e.asset))return null;t=e}return e.crop&&(t.crop=e.crop),e.hotspot&&(t.hotspot=e.hotspot),applyDefaults(t)}function isUrl(e){return/^https?:\/\//.test("".concat(e))}function urlToId(e){return"image-".concat(e.split("/").slice(-1)[0]).replace(/\.([a-z]+)$/,"-$1")}function applyDefaults(e){return e.crop&&e.hotspot?e:_objectSpread({crop:{left:0,top:0,bottom:0,right:0},hotspot:{x:.5,y:.5,height:1,width:1}},e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=parseSource;

},{}],5:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){var r=[],o=!0,a=!1,i=void 0;try{for(var n,c=t[Symbol.iterator]();!(o=(n=c.next()).done)&&(r.push(n.value),!e||r.length!==e);o=!0);}catch(t){a=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw i}}return r}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),o.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function urlForImage(t){var e=_objectSpread({},t||{}),r=e.source;delete e.source;var o=(0,_parseSource.default)(r);if(!o)return null;var a=(0,_parseAssetId.default)(o.asset._ref),i={left:Math.round(o.crop.left*a.width),top:Math.round(o.crop.top*a.height)};i.width=Math.round(a.width-o.crop.right*a.width-i.left),i.height=Math.round(a.height-o.crop.bottom*a.height-i.top);var n=o.hotspot.height*a.height/2,c=o.hotspot.width*a.width/2,h=o.hotspot.x*a.width,u=o.hotspot.y*a.height,l={left:h-c,top:u-n,right:h+c,bottom:u+c};return e.asset=a,e.rect||e.focalPoint||e.ignoreImageParams||e.crop||(e=_objectSpread({},e,fit({crop:i,hotspot:l},e))),specToImageUrl(e)}function specToImageUrl(t){var e=t.baseUrl||"https://cdn.sanity.io",r="".concat(t.asset.id,"-").concat(t.asset.width,"x").concat(t.asset.height,".").concat(t.asset.format),o="".concat(e,"/images/").concat(t.projectId,"/").concat(t.dataset,"/").concat(r),a=[];if(t.rect){(0!=t.rect.left||0!=t.rect.top||t.rect.height!=t.asset.height||t.rect.width!=t.asset.width)&&a.push("rect=".concat(t.rect.left,",").concat(t.rect.top,",").concat(t.rect.width,",").concat(t.rect.height))}return t.bg&&a.push("bg=".concat(t.bg)),t.focalPoint&&(a.push("fp-x=".concat(t.focalPoint.x)),a.push("fp-x=".concat(t.focalPoint.y))),(t.flipHorizontal||t.flipVertical)&&a.push("flip=".concat(t.flipHorizontal?"h":"").concat(t.flipVertical?"v":"")),SPEC_NAME_TO_URL_NAME_MAPPINGS.forEach(function(e){var r=_slicedToArray(e,2),o=r[0],i=r[1];void 0!==t[o]?a.push("".concat(i,"=").concat(encodeURIComponent(t[o]))):void 0!==t[i]&&a.push("".concat(i,"=").concat(encodeURIComponent(t[i])))}),0===a.length?o:"".concat(o,"?").concat(a.join("&"))}function fit(t,e){var r={width:e.width,height:e.height};if(!e.width||!e.height)return r.rect=t.crop,r;var o=t.crop,a=t.hotspot,i=e.width/e.height;if(o.width/o.height>i){var n=o.height,c=n*i,h=o.top,u=(a.right-a.left)/2+a.left,l=u-c/2;return l<o.left?l=o.left:l+c>o.left+o.width&&(l=o.left+o.width-c),r.rect={left:Math.round(l),top:Math.round(h),width:Math.round(c),height:Math.round(n)},r}var p=o.width,f=p/i,s=o.left,d=(a.bottom-a.top)/2+a.top,g=d-f/2;return g<o.top?g=o.top:g+f>o.top+o.height&&(g=o.top+o.height-f),r.rect={left:Math.max(0,Math.floor(s)),top:Math.max(0,Math.floor(g)),width:Math.round(p),height:Math.round(f)},r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=urlForImage,Object.defineProperty(exports,"parseSource",{enumerable:!0,get:function(){return _parseSource.default}});var _parseSource=_interopRequireDefault(require("./parseSource")),_parseAssetId=_interopRequireDefault(require("./parseAssetId")),SPEC_NAME_TO_URL_NAME_MAPPINGS=[["width","w"],["height","h"],["format","fm"],["download","dl"],["blur","blur"],["sharpen","sharp"],["invert","invert"],["orientation","or"],["minHeight","min-h"],["maxHeight","max-h"],["minWidth","min-w"],["maxWidth","max-w"],["quality","q"],["fit","fit"],["crop","crop"]];
},{"./parseAssetId":3,"./parseSource":4}]},{},[1])(1)
});
